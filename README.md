#!
# Wifimonitor

Wifimonitor — десктопное приложение на PyQt5 для пассивного мониторинга Wi‑Fi, захвата WPA/WPA2/WPA3 handshakes и экспорта результатов в Excel и Hashcat. Программа управляет переводом интерфейса в мониторный режим, отображает точки доступа и клиентов в реальном времени и позволяет запускать деаутентификацию выбранных клиентов для ускорения перехвата.

## Основные возможности
- обнаружение и слежение за точками доступа (BSSID, ESSID, канал, шифрование, RSSI) и клиентами;
- непрерывный захват EAPOL кадров с сохранением в pcap и базу SQLite;
- выбор цели для деаутентификации, поддержка отдельного клиента либо всех клиентов точки;
- экспорт данных в `*.xlsx` и хешей в `*.hc22000` при наличии `hcxpcapngtool`;
- автоматическое переключение по каналам для охвата диапазонов 2.4/5 ГГц;
- просмотр оперативных логов (сканирование, handshakes, deauth‑циклы) прямо в интерфейсе.

## Установка
```bash
sudo apt update
sudo apt install -y python3 python3-venv python3-pip aircrack-ng iw

python3 -m venv .venv
source .venv/bin/activate
pip install --upgrade pip
pip install -r requirements.txt
```

## Запуск
```bash
sudo ./.venv/bin/python -m wifimonitor.app
```
При старте появится диалог: выберите существующую или создайте новую SQLite-базу и каталог для файлов захвата. Эти пути можно менять на каждый запуск, что позволяет разделять сессии и отчёты.

### Рабочий процесс
1. В разделе «Мониторинг» выберите интерфейс и нажмите «Старт». Канал-хоппер автоматически переключает частоты, собранные точки и клиенты отображаются в таблицах.
2. На вкладке «Перехват» выберите точку доступа (список доступен только при наличии клиентов) и при необходимости конкретного клиента. Выбранные значения фиксированы и не сбрасываются при обновлении списка.
3. Настройте параметры деаутентификации и запустите атаку. Логи отслеживают прогресс и количество отправленных пакетов, handshakes автоматически попадают в таблицу.
4. Экспортируйте данные в Excel или Hashcat из нижней панели; pcap сохранены в указанном каталоге захватов.

## Хранилище
- по умолчанию файлы создаются в выбранном при запуске каталоге, например `~/.wifimonitor/captures` и `wifimonitor.db`;
- всё состояние (AP, станции, handshakes, логи) записывается в выбранную SQLite БД.

## Безопасность
Приложение рассчитано на исследование собственных сетей. Убедитесь, что имеете разрешение на перехват и деаутентификацию, и запускайте программу только с правами `root`/`sudo` на системах, где это допускается.
   Depends: python3 (>= 3.10), aircrack-ng, iw
   Description: GUI-инструмент для мониторинга Wi-Fi и перехвата handshake
    Утилита с интерфейсом на PyQt5 для Kali Linux. Поддерживает мониторинг,
    перехват WPA handshakes, деаутентификацию, экспорт в Hashcat и Excel.
   EOF
   ```

7. Соберите пакет:
   ```bash
   dpkg-deb --build "$PKG_ROOT" "${PKG_NAME}_${VERSION}_all.deb"
   ```

8. Установите и протестируйте:
   ```bash
   sudo dpkg -i "${PKG_NAME}_${VERSION}_all.deb"
   sudo wifimonitor
   ```

При необходимости добавьте в `DEBIAN/postinst` запуск `ldconfig`, проверку зависимостей или создание ярлыка `.desktop`.

## Диагностика
- Если интерфейс не появляется в списке, проверьте наличие беспроводных адаптеров: `iw dev`.
- Для корректной работы деаутентификации требуется поддержка режима мониторинга и пакетной отправки на адаптере.
- При ошибках `hcxpcapngtool` убедитесь, что утилита установлена: `sudo apt install hcxtools`.
- Логи приложения и дампы хранятся в `~/.wifimonitor`.

## Правовой статус
Автор программы и сопровождающие не несут ответственности за незаконное использование. Перед эксплуатацией убедитесь, что у вас есть разрешение на тестирование соответствующей сети.
